/* webcube.product.min.js */
function eval_hash_object(a){for(key in a){return true}return false}function product_has_feature(b,a){if(!b.selector.attr("data-productfeatures")){return false}return b.selector.attr("data-productfeatures").search(a)!=-1}function register_update_product_image(e){if(!product_has_feature(e,"media")){return}var a=e.selector;var c=a.find(".media");var f=a.find(".thumbnails a");function b(i,k){var g={};for(index in i.option_keys){var j=i.option_keys[index],h;if(k.dataset){h=k.dataset[j]}else{h=k.getAttribute("data-"+j)}if(h){g[j]=h}}return g}function d(h){var g=Array();f.each(function(){var j=0;var i=b(h,this);for(key in h.selected_options){if(i[key]){if(i[key]!=h.selected_options[key]){return}j+=1}}g.push([j,this])});g=g.sort(function(j,i){return j[0]<i[0]});if(g.length){$(g[0]).click()}}if(c.length){e.selector.bind("option-selected",function(g,h){d(h)});f.click(function(h){if(!h.originalEvent){return false}var g=b(e,this);if(eval_hash_object(g)){e.select_option(g)}return false})}}function register_update_option_dropdown(b){if(!product_has_feature(b,"options")){return}b.selector.bind("option-selected",function(g,h){for(a in h.available_options){var e=h.available_options[a];var d=h.selector.find('select[name="'+a+'"]');var c=h.selected_options[a]||d.val();d.children('[value!=""]').remove();for(option_index in e){var i=e[option_index];var f=new Option();$(f).attr("value",i).text(i);d.append(f)}d.val(c)}});for(index in b.option_keys){var a=b.option_keys[index];b.selector.find('select[name="'+a+'"]').change(function(){var c={};c[$(this).attr("name")]=$(this).val();b.select_option(c)})}}function register_update_product_form(a){if(!product_has_feature(a,"options")){return}a.selector.bind("option-selected",function(b,c,e){if(e.length==1){var f=e[0];for(key in f){if(key==="content_type"){}c.selector.find(':input[name="'+key+'"]').filter(function(){return !$(this).closest(".reviews").length}).val(f[key])}var d=c.selector.find(".price .sale");if(d.length){d.text(f.price)}else{c.selector.find(".price").text(f.price)}c.selector.find(".sku").text(f.sku);if(f.availability_date){$("#availability_date").text(f.availability_date);$(".availability_date").show()}else{$(".availability_date").hide()}if(f.can_order){c.selector.find(".add_to_cart :input").removeAttr("disabled");c.selector.find(".add_to_cart_preorder :input").removeAttr("disabled")}else{c.selector.find(".add_to_cart :input").attr("disabled","disabled");c.selector.find(".add_to_cart_preorder :input").attr("disabled","disabled")}if(f.in_stock){c.selector.find(".add_to_cart").show();c.selector.find(".add_to_cart_preorder").hide();c.selector.find('form[name="request_instock_notification"]').hide()}else{if(f.can_order){c.selector.find(".add_to_cart").hide();c.selector.find(".add_to_cart_preorder").show()}else{c.selector.find(".add_to_cart").show();c.selector.find(".add_to_cart_preorder").hide()}c.selector.find('form[name="request_instock_notification"]').show()}}});a.selector.find("form").submit(function(){sku_input=$(this).find(':input[name="sku"]');if(sku_input.length&&!sku_input.val()){alert("Please select a valid option");return false}})}function register_color_swatch_for_product(e){if(!product_has_feature(e,"options")){return}var a=e.selector;var c=a.find(".graphicoption");var b=c.find("li");var d=c.find("a");if(!a.hasClass("item")){c.after('<div class="graphicoption_display hidden"/>');d.hover(function(){var f=$(".grouped_product").length!==0?$(this).parents(".grouped_product"):$(this).parents("div.product, div#product");var g=['<div class="thumb">','<img src="'+$(this).find("img").attr("src")+'" />',"</div>",'<p class="info">'+$(this).find("img").attr("alt")+"</p>"];f.find(".graphicoption_display").html(g.join("")).removeClass("hidden")},function(){var f=$(".grouped_product").length!==0?$(this).parents(".grouped_product"):$(this).parents("div.product, div#product");f.find(".graphicoption_display").addClass("hidden")});d.click(function(){var f=$(this).find("img"),g={};b.removeClass("active");$(this).parents("li").addClass("active");g[f.attr("data-option")]=f.attr("alt");e.select_option(g);return false})}e.selector.bind("option-selected",function(g,i,j,f){b.removeClass("active");for(key in f){var h=f[key];b.has('img[alt="'+h+'"][data-option="'+key+'"]').addClass("active")}})}function register_review_form_for_product(a){if(!a.selector.find("#write_review_form").length){return}function b(){WebCube.catalog.ratings_form("#write_review_form form")}WebCube.catalog.comments_form("#write_review_form form","#write_review_form",b);$("#write_review_button a").click(function(){if($("#write_review_form").hasClass("active")){$(this).text("Write A Review");$("#write_review_form").removeClass("active")}else{$(this).text("Cancel Review");$("#write_review_form").addClass("active")}return false})}WebCube.catalog.registerProductListener(register_update_option_dropdown);WebCube.catalog.registerProductListener(register_update_product_form);WebCube.catalog.registerProductListener(register_update_product_image);WebCube.catalog.registerProductListener(register_color_swatch_for_product);